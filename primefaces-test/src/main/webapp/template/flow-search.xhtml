<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	
	<ui:composition>
		<style>
			:root {
				--color: #ABB2BF;
				--bg-color: #282C34;
				--border-color: #4B5263;
				--surface-color: #353B45;
			}
			
			.overlay {
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: none;
				z-index: 1000;
				position: fixed;
				padding-top: 100px;
				justify-content: center;
				background: rgba(0, 0, 0, 0.75);
			}
			
			.launcher {
				width: 80%;
				overflow: hidden;
				height: fit-content;
				border-radius: 12px;
				background: var(--bg-color);
				animation: slideIn 0.2s ease-out;
				border: 1px solid var(--border-color);
				box-shadow: 0 20px 50px rgba(0,0,0,0.5);
			}
			
			@keyframes slideIn {
				to { transform: translateY(0); opacity: 1; }
				from { transform: translateY(-20px); opacity: 0; }
			}
			
			.search-container {
				padding: 20px;
			}
			
			input {
				width: 100%;
				border: none;
				outline: none;
				font-size: 22px;
				background: transparent;
				color: var(--color-white);
			}
			
			#results {
				padding: 10px;
				overflow-y: auto;
				max-height: 300px;
				border-top: 1px solid var(--border-color);
			}
			
			.result-item {
				cursor: pointer;
				padding: 15px 20px;
				border-radius: 10px;
				color: var(--color-white);
			}
			
			.result-item:hover, .result-item.active {
				background: var(--surface-color);
			}
			
			.item-sub {
				display: block;
				font-size: 12px;
				color: var(--color);
			}
			
			.no-results {
				padding: 20px;
				font-style: italic;
				text-align: center;
				color: var(--color);
			}
		</style>
		
		<div class="overlay" id="launcherOverlay">
			<div class="launcher">
				<div class="search-container">
					<input type="text" id="searchBox" placeholder="Buscar..." autocomplete="off"></input>
				</div>
				
				<div id="results"></div>
			</div>
		</div>
		
		<script>
			const overlay = document.getElementById('launcherOverlay');
			const searchBox = document.getElementById('searchBox');
			const results = document.getElementById('results');
			const apps = #{inicioBean.dados};
			
			function openLauncher() {
				overlay.style.display = 'flex';
				searchBox.focus();
				populateResults(apps);
			}
			
			function closeLauncher() {
				overlay.style.display = 'none';
				searchBox.value = '';
				results.innerHTML = '';
			}
			
			overlay.addEventListener('click', (e) => {
				if(e.target === overlay) closeLauncher();
			});
			
			window.addEventListener('keydown', (e) => {
				if (e.code === 'Escape') {
					e.preventDefault();
					overlay.style.display === 'flex' ? closeLauncher() : openLauncher();
				}
			});
			
			searchBox.addEventListener('input', (e) => {
				const val = e.target.value.toLowerCase();
				results.innerHTML = '';
				
				if (!val) {
					populateResults(apps);
					return;
				}
				
				const filtered = apps.filter(a => a.name.toLowerCase().includes(val));
				populateResults(filtered);
			});
			
			function populateResults(filteredApps) {
				results.innerHTML = '';
				
				if (filteredApps.length === 0) {
					const div = document.createElement("div");
					div.className = 'result-item no-results';
					div.textContent = 'Nenhum resultado encontrado';
					results.appendChild(div);
					return;
				}
				
				filteredApps.forEach(app => {
					const link = document.createElement('a');
					link.href = app.desc;
					link.title = app.name;
					
					const div = document.createElement("div");
					div.className = 'result-item';
					
					const strong = document.createElement('strong');
					strong.textContent = app.name;
					
					const span = document.createElement('span');
					span.className = 'item-sub';
					span.textContent = app.desc;
					
					div.appendChild(strong);
					div.appendChild(span);
					link.appendChild(div);
					
					div.onclick = () => { closeLauncher(); };
					results.appendChild(link);
				});
			}
		</script>
	</ui:composition>
</html>